# Spring Boot Application Configuration
spring:
  application:
    name: keycloak-resource-server

# Server Configuration
server:
  port: 8080
  servlet:
    session:
      cookie:
        name: BFFSESSION
        http-only: true
        secure: false  # Set to true in production with HTTPS
        same-site: lax
        path: /

# OAuth2 Client Configuration for BFF Pattern
spring.security.oauth2.client:
  registration:
    keycloak:
      client-id: ${KEYCLOAK_CLIENT_ID:react-client}
      client-secret: ${KEYCLOAK_CLIENT_SECRET:}
      authorization-grant-type: authorization_code
      redirect-uri: "{baseUrl}/login/oauth2/code/keycloak"
      scope: openid,profile,email,groups
  provider:
    keycloak:
      issuer-uri: ${KEYCLOAK_ISSUER_URI:http://localhost:8180/realms/demo}
      user-name-attribute: preferred_username

# Redis Session Configuration
spring:
  session:
    store-type: redis
    timeout: 3600  # 1 hour in seconds
    redis:
      namespace: spring:session
  redis:
    host: ${REDIS_HOST:localhost}
    port: ${REDIS_PORT:6379}
    password: ${REDIS_PASSWORD:}

# CORS Configuration
app:
  cors:
    # Comma-separated list of allowed origins for CORS
    allowed-origins: ${CORS_ALLOWED_ORIGINS:http://localhost:3000,http://localhost:5173}

# Logging Configuration
logging:
  level:
    root: INFO
    com.example.demo: DEBUG
    org.springframework.security: DEBUG
    org.springframework.security.oauth2: DEBUG

# Actuator Configuration
management:
  endpoints:
    web:
      exposure:
        include: health,info
  endpoint:
    health:
      show-details: when_authorized

---
# Development Profile
spring:
  config:
    activate:
      on-profile: dev

logging:
  level:
    org.springframework.security: TRACE

---
# Production Profile
spring:
  config:
    activate:
      on-profile: prod

logging:
  level:
    root: WARN
    com.example.demo: INFO
    org.springframework.security: WARN
